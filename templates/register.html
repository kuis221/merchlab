<!DOCTYPE html>
<html>
<head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <!-- Page title -->
    <title>MerchLab</title>

    <!-- Place favicon.ico and apple-touch-icon.png in the root directory -->
    <!--<link rel="shortcut icon" type="image/ico" href="favicon.ico" />-->

    <!-- Vendor styles -->
    <link rel="stylesheet" href="/static/vendor/fontawesome/css/font-awesome.css" />
    <link rel="stylesheet" href="/static/vendor/metisMenu/dist/metisMenu.css" />
    <link rel="stylesheet" href="/static/vendor/animate.css/animate.css" />
    <link rel="stylesheet" href="/static/vendor/bootstrap/dist/css/bootstrap.css" />
    <link rel="stylesheet" href="/static/vendor/sweetalert/lib/sweet-alert.css" />

    <!-- App styles -->
    <link rel="stylesheet" href="/static/fonts/pe-icon-7-stroke/css/pe-icon-7-stroke.css" />
    <link rel="stylesheet" href="/static/fonts/pe-icon-7-stroke/css/helper.css" />
    <link rel="stylesheet" href="/static/styles/style.css">

    <!-- Begin Inspectlet Embed Code -->
    <script type="text/javascript" id="inspectletjs">
    window.__insp = window.__insp || [];
    __insp.push(['wid', 1355144002]);
    (function() {
    function ldinsp(){if(typeof window.__inspld != "undefined") return; window.__inspld = 1; var insp = document.createElement('script'); insp.type = 'text/javascript'; insp.async = true; insp.id = "inspsync"; insp.src = ('https:' == document.location.protocol ? 'https' : 'http') + '://cdn.inspectlet.com/inspectlet.js'; var x = document.getElementsByTagName('script')[0]; x.parentNode.insertBefore(insp, x); };
    setTimeout(ldinsp, 500); document.readyState != "complete" ? (window.attachEvent ? window.attachEvent('onload', ldinsp) : window.addEventListener('load', ldinsp, false)) : ldinsp();
    })();
    </script>
    <!-- End Inspectlet Embed Code -->

    <!-- Intercom Integration Code -->
    <script>
      window.intercomSettings = {
        app_id: "zj7fd4cy"
      };
    </script>
    <script>(function(){var w=window;var ic=w.Intercom;if(typeof ic==="function"){ic('reattach_activator');ic('update',intercomSettings);}else{var d=document;var i=function(){i.c(arguments)};i.q=[];i.c=function(args){i.q.push(args)};w.Intercom=i;function l(){var s=d.createElement('script');s.type='text/javascript';s.async=true;s.src='https://widget.intercom.io/widget/zj7fd4cy';var x=d.getElementsByTagName('script')[0];x.parentNode.insertBefore(s,x);}if(w.attachEvent){w.attachEvent('onload',l);}else{w.addEventListener('load',l,false);}}})()</script>
    <!-- End Intercom Integration Code -->


    <style>
    label {
        font-weight:300;
    }
    </style>
</head>
<body class="blank">


<!--[if lt IE 7]>
<p class="alert alert-danger">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
<![endif]-->

<div></div>
<div class="container-fluid">
<div class="row" style="margin-top:10px">
        <div class="col-md-5">
            <div class="hpanel">
                <div class="panel-body">
                    <h2>Ready to Streamline Your Merch By Amazon Research?</h2>
                    <hr />
                    <div class="alert alert-warning fade in alert-dismissable">
                        <a href="#" class="close" data-dismiss="alert" aria-label="close" title="close">Ã—</a>
                        <strong>WARNING: LIMITED SEATING! <span class="text-danger">There's less than {{num_seats_left}} spots left.</span></strong> <br />Guarantee your spot by being a founder's club member. We won't re-open registration for a while after this</b>, so that our true fans can leverage unparalleled data tools and secure their advantage before anyone else.
                    </div>
                    <br />
                    <p><b>MerchLab Founder's Club package can help you</b> discover trends and top-selling shirts in the largest MBA database ever, and know why they're selling. Currently we have 4.5 million shirts and hundreds of thousands pulled each day!</p>

                    <br /><br />
                    <img src="/static/images/example.png" style="width:100%"></img>
                </div>
            </div>
        </div>
        <div class="col-md-7">

            <div class="hpanel">
                <div class="panel-body">
                    <div class="row">
                        <div class="col-lg-12">

                            <div class="text-center m-b-md">
                                <p><b>INTRODUCING MERCHLAB FOUNDER'S CLUB</b></p>
                                <h2>PRICING: <span class="text-success">$69 LIFETIME</span> <small>(OFFER ENDS 12/16)</small></h2>
                            </div>
                        </div>
                    </div>
                    <hr style="margin-top:0px"/>

                    {% if error == "username_exists" %}

                      <div class="alert alert-danger" role="alert">
                          <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
                            <b>Oh snap</b>, that username already exists!
                      </div>
                      <br>

                    {% elif error == "email_exists" %}

                      <div class="alert alert-danger" role="alert">
                          <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
                            <b>Oh snap</b>, that email already exists!
                      </div>
                      <br>

                    {% elif error == "required_field_missing" %}

                      <div class="alert alert-danger" role="alert">
                          <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
                            <b>Oh snap</b>, one of the fields has not been filled out!
                      </div>
                      <br>

                    {% elif error == "wrong_access_code" %}

                      <div class="alert alert-danger" role="alert">
                          <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
                            <b>Oh snap</b>, your access code is wrong!
                      </div>
                      <br>

                    {% elif error and error != "" %}
                      <div class="alert alert-danger" role="alert">
                          <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
                            <b>Oh snap</b>, {{error}}
                      </div>           
                      <br>

                    {% endif %}

                    <form method="post" id="registrationForm">
                        <br />
                        <div class="row">
                            <div class="form-group col-lg-12">
                                <label>USERNAME</label>
                                <input type="text" id="username" value="" class="form-control" name="username">
                            </div>
                            <div class="form-group col-lg-12">
                                <label>EMAIL ADDRESS</label>
                                <input type="text" value="" id="email" class="form-control" name="email">
                            </div>
                            <div class="form-group col-lg-12">
                                <label>PASSWORD</label>
                                <input type="password" id="password" value="" class="form-control" name="password">
                            </div>
                        </div>
                        <br />
                        <div class="row">
                            <div class="form-group col-lg-6">
                                <label>CARD NUMBER</label>
                                <input type="text" class="form-control cc-num" autocomplete="off" id="" data-stripe="number">
                            </div>
                            <div class="form-group col-lg-2">
                                <label>CVC</label>
                                <input type="text" class="form-control cc-cvc" autocomplete="off" id="" data-stripe="cvc">
                            </div>
                            <div class="form-group col-lg-2">
                                <label>EXP MONTH</label><br />
                                <input type="text" placeholder="MM" data-stripe="exp-month" class="form-control"/>

                                <!--
                                <select class="selectpicker form-control" placeholder="MM" autocomplete="off" data-stripe="exp-month" id="exp-month">
                                    <option>01</option>
                                    <option>02</option>
                                    <option>03</option>
                                    <option>04</option>
                                    <option>05</option>
                                    <option>06</option>
                                    <option>07</option>
                                    <option>08</option>
                                    <option>09</option>
                                    <option>10</option>
                                    <option>11</option>
                                    <option>12</option>
                                </select>
                                -->
                            </div>
                            <div class="form-group col-lg-2">
                                <label>EXP YEAR</label><br />
                                <input type="text" placeholder="YYYY" data-stripe="exp-year" class="form-control"/>

                            </div>
                        </div>
                        <hr />
                        <br />
                        <div class="row">
                            <div class="text-center col-lg-12">
                                <button class="btn btn-lg btn-primary" style="width:100%" id="register">REGISTER NOW!</button>
                                <br /><br />
                                <a href="{{url_for('login')}}"><button class="btn btn-lg btn-default" style="font-weight:300; width:100%" type="button">ALREADY A MEMBER? CLICK TO LOGIN.</button></a>

                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

</div>



<!-- Vendor scripts -->
<script src="/static/vendor/jquery/dist/jquery.min.js"></script>
<script src="/static/vendor/jquery-ui/jquery-ui.min.js"></script>
<script src="/static/vendor/slimScroll/jquery.slimscroll.min.js"></script>
<script src="/static/vendor/bootstrap/dist/js/bootstrap.min.js"></script>
<script src="/static/vendor/metisMenu/dist/metisMenu.min.js"></script>
<script src="/static/vendor/iCheck/icheck.min.js"></script>
<script src="/static/vendor/sparkline/index.js"></script>
<script src="/static/vendor/jquery-validation/jquery.validate.min.js"></script>
<script src="/static/vendor/jquery-payments/jquery.payment.min.js"></script>
<script src="/static/vendor/sweetalert/lib/sweet-alert.min.js"></script>
<script type="text/javascript" src="https://js.stripe.com/v2/"></script>

<!-- App scripts -->
<script src="/static/scripts/homer.js"></script>


<script type="text/javascript">

    $('input.cc-num').payment('formatCardNumber');
    //$('input.cc-exp').payment('formatCardExpiry');
    $('input.cc-cvc').payment('formatCardCVC');    
    // This identifies your website in the createToken call below
    Stripe.setPublishableKey('pk_live_UyHYEEzZeMgveaVgPX8SFGvP');
    // ...

    function stripeResponseHandler(status, response) {
      var $form = $('#registrationForm');
      console.log("here, supposed to log...")
      if (response.error) {
        // Show the errors on the form
        swal({
            title: "Something's not right with your card info!",
            text: response.error.message,
            type: "error"
        }); 

        $form.find('button').prop('disabled', false);
      } else {
        // response contains id and card, which contains additional card details
        var token = response.id;
        // Insert the token into the form so it gets submitted to the server
        $form.append($('<input type="hidden" name="stripeToken" />').val(token));

        if (location.search != "") {
            var rawParamsList = location.search.slice(1).split('&')
            var paramsList = [];
            for (var c=0; c<rawParamsList.length; c++) {
                var paramName = rawParamsList[c].split('=')[0];
                var paramVal = rawParamsList[c].split('=')[1];
                if (paramName == "ref" || paramName == "referrer") {
                    $form.append($('<input type="hidden" name="referrerId" />').val(paramVal));
                    break;
                }
            } 
        }

        // and submit
        console.log("this is token: " + token)

        $form.get(0).submit();
      }
    };


    $(function(){

        jQuery.validator.addMethod("alphanumeric", function(value, element) {
            return this.optional(element) || /^\w+$/i.test(value);
        }, "Letters, numbers, and underscores only please.");

        $("#registrationForm").validate({
            rules: {
                password: {
                    required: true,
                    minlength: 3
                },
                email: {
                    required: true,
                    email: true
                },
                username: {
                    required: true,
                    minlength: 3,
                    alphanumeric: true
                }
            },
            submitHandler: function(form) {
                //form.submit();

                var $form = $("#registrationForm");

                // Disable the submit button to prevent repeated clicks
                $form.find('button').prop('disabled', true);

                Stripe.card.createToken($form, stripeResponseHandler);

                // Prevent the form from submitting with the default action
                return false;
            }
        });
    });

</script>

</body>
</html>